143.066997 seconds (269.93 M allocations: 148.080 GiB, 19.55% gc time)
156.493112 seconds (262.45 M allocations: 149.135 GiB, 17.53% gc time)

Model without indexation of F on A and phi

Nphi = 100, Npart = 1000

-----------------------------------------------
 Iteration = 100 / 100 
-----------------------------------------------
 phi  = 1.0 
-----------------------------------------------
  c    = 0.3324572239546922
  acpt = 0.224
  ESS  = 912.13099732853  (14 total resamples.)
-----------------------------------------------
para      mean    std
------    ----    ----
ρ_A     0.8766521108526415    0.0353450454430424
ρ_μ     0.46785486029194107    0.10125224683643379
ρ_g     0.8671566656799876    0.042533245091901005
ρ_R     0.4114801468245    0.07858069998872008
ρ_π     2.514116107883086    0.31468576003872256
ρ_y     0.12779204493597252    0.10200971049598558
ψ     0.8004190341864985    0.031667199321017456
σ_A     0.29132959472654607    0.03216862239819456
σ_μ     0.17814348511880712    0.03847065453966978
σ_g     3.1269443742881826    0.3324532907671497
σ_m     0.5607058521407037    0.060155967824527395
150.558814 seconds (302.91 M allocations: 150.811 GiB, 19.78% gc time)
-----------------------------------------------
logML = -130.9814695020984
-----------------------------------------------

Nphi = 100, Npart = 1000 ; parallel

-----------------------------------------------
 Iteration = 100 / 100 
-----------------------------------------------
 phi  = 1.0 
-----------------------------------------------
  c    = 0.1668767652542397
  acpt = 0.227
  ESS  = 990.0186362457548  (15 total resamples.)
-----------------------------------------------
para      mean    std
------    ----    ----
ρ_A     0.8183396059392838    0.04854937098278265
ρ_μ     0.40477555816308425    0.05590695069873352
ρ_g     0.8874049339336414    0.0504316842461298
ρ_R     0.34827020536874675    0.0947537588599771
ρ_π     2.9251859005244514    0.3663558382990253
ρ_y     0.08311592189635494    0.10817711476596084
ψ     0.7888187997929195    0.02526854389145395
σ_A     0.2922417010805147    0.023142080929802623
σ_μ     0.20103281072164572    0.022465125393666456
σ_g     2.691889102327057    0.5213865083714645
σ_m     0.5650593504464054    0.06997085996792661
 26.287379 seconds (1.14 M allocations: 225.103 MiB, 0.20% gc time)
-----------------------------------------------
logML = -136.55007140340172
-----------------------------------------------

Nphi = 100, Npart = 10000

-----------------------------------------------
 Iteration = 100 / 100 
-----------------------------------------------
 phi  = 1.0 
-----------------------------------------------
  c    = 0.16006615384056383
  acpt = 0.2515
  ESS  = 5470.402009790476  (12 total resamples.)
-----------------------------------------------
para      mean    std
------    ----    ----
ρ_A     0.7164067681573572    0.06389323114168338
ρ_μ     0.31089702602689684    0.1402493954381119
ρ_g     0.8438668329017518    0.029884758422851956
ρ_R     0.7694443672704591    0.05118041666402673
ρ_π     1.5748094109527782    0.3490156385213213
ρ_y     1.2593000680893902    0.21102525328523003
ψ     0.8094893776794294    0.02932612163000134
σ_A     0.2997739429445988    0.03173960792331698
σ_μ     0.20230583655346152    0.042437349224863766
σ_g     11.594713510884333    1.0991075397388992
σ_m     0.3081972349379928    0.041570842374061855
249.013629 seconds (14.36 M allocations: 6.200 GiB, 0.52% gc time)
-----------------------------------------------
logML = -100.01674384269026
-----------------------------------------------

Nphi = 400, Npart = 4000

-----------------------------------------------
 Iteration = 400 / 400 
-----------------------------------------------
 phi  = 1.0 
-----------------------------------------------
  c    = 0.14299513951300963
  acpt = 0.2495
  ESS  = 2287.3246941553716  (13 total resamples.)
-----------------------------------------------
para      mean    std
------    ----    ----
ρ_A     0.7169255315871788    0.07137493210690016
ρ_μ     0.27991125410625695    0.15502588188959635
ρ_g     0.8218401457863216    0.036530201825655945
ρ_R     0.7235331533654088    0.05940543423911783
ρ_π     1.6496588810348745    0.4775349281797625
ρ_y     1.0425483914512863    0.20768730724807924
ψ     0.8117114627814348    0.033721137572233814
σ_A     0.30360081354025614    0.033614367695624314
σ_μ     0.21541101821254116    0.05364507313960381
σ_g     9.585340294569395    1.2376791961561466
σ_m     0.32720378297120856    0.04899600997659201
404.075410 seconds (3.73 M allocations: 2.630 GiB, 0.16% gc time)
-----------------------------------------------
logML = -102.57280201823892
-----------------------------------------------

When indexing F on phi and A

Npart = 1000

-----------------------------------------------
 Iteration = 100 / 100 
-----------------------------------------------
 phi  = 1.0 
-----------------------------------------------
  c    = 0.40778725199157656
  acpt = 0.276
  ESS  = 873.1485888763004  (13 total resamples.)
-----------------------------------------------
para      mean    std
------    ----    ----
ρ_A     0.7434039737296961    0.07412332910732986
ρ_μ     0.20547680964212997    0.1387963001134451
ρ_g     0.7572142241087324    0.03775728572253148
ρ_R     0.5859410740227926    0.08173382187804289
ρ_π     2.0033235463704018    0.4999473460252522
ρ_y     0.7144312179929966    0.1580039332093581
ψ     0.816278074424876    0.032182955145609086
σ_A     0.3146728249839501    0.040107337094444875
σ_μ     0.24541283561468719    0.05143244523211457
σ_g     5.408218615957016    0.38858574982859545
σ_m     0.4031511702236116    0.07718224192012395
 29.323254 seconds (3.12 M allocations: 316.710 MiB, 0.49% gc time)
-----------------------------------------------
logML = -123.73880579978463
-----------------------------------------------

Npart = 10000

-----------------------------------------------
 Iteration = 100 / 100 
-----------------------------------------------
 phi  = 1.0 
-----------------------------------------------
  c    = 0.08739057924978952
  acpt = 0.2309
  ESS  = 8857.741805879938  (12 total resamples.)
-----------------------------------------------
para      mean    std
------    ----    ----
ρ_A     0.7363198907091807    0.06226310139306267
ρ_μ     0.25258509140505203    0.12013369991277997
ρ_g     0.8583776341220951    0.03385608632013979
ρ_R     0.736168971713814    0.052076747206973084
ρ_π     1.9346511684504515    0.728947417589852
ρ_y     1.0424519020001064    0.22598746134450948
ψ     0.8118037173367803    0.030248141182454145
σ_A     0.31299185595128587    0.037898894463625966
σ_μ     0.21545098642390675    0.04536117789822054
σ_g     11.745966865635996    2.139901170740704
σ_m     0.3160731522832868    0.04970925195181185
247.556146 seconds (1.28 M allocations: 5.569 GiB, 0.43% gc time)
-----------------------------------------------
logML = -104.68068617270627
-----------------------------------------------
247.556257 seconds (1.28 M allocations: 5.569 GiB, 0.43% gc time)

Npart = 1000

-----------------------------------------------
 Iteration = 400 / 400 
-----------------------------------------------
 phi  = 1.0 
-----------------------------------------------
  c    = 0.2353563284708037
  acpt = 0.248
  ESS  = 946.992214085137  (14 total resamples.)
-----------------------------------------------
para      mean    std
------    ----    ----
ρ_A     0.7294364689462831    0.06412962825119528
ρ_μ     0.20498843245433257    0.12182450810407647
ρ_g     0.7856858829658605    0.03544389906579678
ρ_R     0.6817209831586565    0.07326350807710397
ρ_π     2.2774702030748077    0.6546113907044201
ρ_y     0.9859553228020643    0.21654306392576245
ψ     0.8091832551299248    0.03128376895407054
σ_A     0.31027242772909147    0.03656398018296046
σ_μ     0.23144410206487326    0.04184033564020111
σ_g     7.246128033960605    0.8054014793429051
σ_m     0.3565249654704011    0.058930418501249804
105.224734 seconds (3.36 M allocations: 661.635 MiB, 0.16% gc time)
-----------------------------------------------
logML = -115.50122772096198
-----------------------------------------------
105.611259 seconds (3.72 M allocations: 676.987 MiB, 0.15% gc time)

Npart = 10000

-----------------------------------------------
 Iteration = 1000 / 1000 
-----------------------------------------------
 phi  = 1.0 
-----------------------------------------------
  c    = 0.05648452885311251
  acpt = 0.247
  ESS  = 6062.780522475433  (12 total resamples.)
-----------------------------------------------
para      mean    std
------    ----    ----
ρ_A     0.735175565595227    0.06310877141499875
ρ_μ     0.23944741280399676    0.128990433139518
ρ_g     0.8460121345005596    0.04172585019821373
ρ_R     0.7327544260833463    0.05869647254767926
ρ_π     2.0241068834282787    0.6043466003452184
ρ_y     1.1090985706989587    0.22321893014862118
ψ     0.8102565238795417    0.028445555590793484
σ_A     0.3095557652705818    0.033623843714328645
σ_μ     0.22261000837472394    0.045486136819395534
σ_g     11.273074091862595    2.8509410484667743
σ_m     0.32665249163162685    0.048812145128843965
2545.475423 seconds (34.82 M allocations: 16.534 GiB, 0.13% gc time)
-----------------------------------------------
logML = -106.47956259650846
-----------------------------------------------

Experiment -> 100,000 likelihood computations

400;250

-----------------------------------------------
 Iteration = 400 / 400 
-----------------------------------------------
 phi  = 1.0 
-----------------------------------------------
  c    = 0.29318524762749787
  acpt = 0.248
  ESS  = 231.41482974164632  (15 total resamples.)
-----------------------------------------------
para      mean    std
------    ----    ----
ρ_A     0.8601666033654477    0.03510764728591729
ρ_μ     0.4845377200509608    0.08536961934363368
ρ_g     0.865079926111051    0.042109828840132056
ρ_R     0.29733994869108266    0.1078127486739265
ρ_π     2.390492906546477    0.24094615479660303
ρ_y     0.09591379009975322    0.08293749709753787
ψ     0.8015655468364962    0.028438630486547482
σ_A     0.2954369691986531    0.03135641280788071
σ_μ     0.17820877385887096    0.03644271457906739
σ_g     2.7134896141191813    0.2655984335469164
σ_m     0.735708216055614    0.11494740979110958
 32.754195 seconds (3.31 M allocations: 391.788 MiB, 0.42% gc time)
-----------------------------------------------
logML = -141.4720938245879
-----------------------------------------------

200;500

-----------------------------------------------
 Iteration = 200 / 200 
-----------------------------------------------
 phi  = 1.0 
-----------------------------------------------
  c    = 0.34422689535222734
  acpt = 0.234
  ESS  = 495.97180480207646  (13 total resamples.)
-----------------------------------------------
para      mean    std
------    ----    ----
ρ_A     0.7402402329862271    0.06416235861367248
ρ_μ     0.24991703056302336    0.11597512883436245
ρ_g     0.7927954281903449    0.0353646264779733
ρ_R     0.6813353493712683    0.06450604617707147
ρ_π     1.8261496778326256    0.5311304039678447
ρ_y     0.9390958039338344    0.16151192841885412
ψ     0.8090836030596934    0.02752145921646999
σ_A     0.3139345366510327    0.03751328923119314
σ_μ     0.21637420457506812    0.03743047687190349
σ_g     7.504805552383797    0.5139999970205686
σ_m     0.34717493191012516    0.055018228530408865
 30.625993 seconds (2.24 M allocations: 336.135 MiB, 0.33% gc time)
-----------------------------------------------
logML = -109.07711736658351
-----------------------------------------------

100;1000

-----------------------------------------------
 Iteration = 100 / 100 
-----------------------------------------------
 phi  = 1.0 
-----------------------------------------------
  c    = 0.4651835339998443
  acpt = 0.239
  ESS  = 755.708001934591  (13 total resamples.)
-----------------------------------------------
para      mean    std
------    ----    ----
ρ_A     0.7436826081681677    0.06936429862639823
ρ_μ     0.199361248305425    0.11720070744898789
ρ_g     0.7646629383822142    0.03573813560313892
ρ_R     0.6135204597358185    0.06470010164537784
ρ_π     2.26713251741024    0.6956486695078111
ρ_y     0.707734618606152    0.1409420392273139
ψ     0.8144789876088341    0.02812095869651089
σ_A     0.30326769332127074    0.03407047592930869
σ_μ     0.24025827732497293    0.04388187748725263
σ_g     5.59993531995479    0.2768548450936888
σ_m     0.37981037023798087    0.05940193400464459
 29.101118 seconds (1.13 M allocations: 216.150 MiB, 0.22% gc time)
-----------------------------------------------
logML = -121.6918083288119
-----------------------------------------------

50;2000

-----------------------------------------------
 Iteration = 50 / 50 
-----------------------------------------------
 phi  = 1.0 
-----------------------------------------------
  c    = 0.5382814992669938
  acpt = 0.2155
  ESS  = 1783.5375290335294  (12 total resamples.)
-----------------------------------------------
para      mean    std
------    ----    ----
ρ_A     0.7153187944387113    0.06532676328246666
ρ_μ     0.21508020059667116    0.1165303562664178
ρ_g     0.7886871507434268    0.03456169257770284
ρ_R     0.7452855031371584    0.04360732310753933
ρ_π     1.816346059756917    0.4016255011481472
ρ_y     1.0260876390021079    0.1475164531793857
ψ     0.8029732593677215    0.02981777128841965
σ_A     0.3136440239174858    0.034558435681537374
σ_μ     0.2287162236056285    0.040744694584134176
σ_g     8.070037502262693    0.3306886591520004
σ_m     0.2707912917435686    0.02685620535462258
 28.236638 seconds (771.71 k allocations: 334.585 MiB, 0.31% gc time)
-----------------------------------------------
logML = -116.06076717041236
-----------------------------------------------

25;4000

-----------------------------------------------
 Iteration = 25 / 25 
-----------------------------------------------
 phi  = 1.0 
-----------------------------------------------
  c    = 0.6348738185605738
  acpt = 0.199
  ESS  = 2052.9883318101975  (10 total resamples.)
-----------------------------------------------
para      mean    std
------    ----    ----
ρ_A     0.703773219715934    0.07563861121109469
ρ_μ     0.2655688020398791    0.12377122123899795
ρ_g     0.735946679607807    0.044542443506998444
ρ_R     0.6551335265894435    0.05300929489129276
ρ_π     1.888936708588642    0.34879692724584216
ρ_y     0.6547159119019952    0.12704793002290632
ψ     0.8080708970325294    0.03380610507608757
σ_A     0.3227535176148423    0.03453875201583682
σ_μ     0.20665355237789865    0.03855254158687473
σ_g     5.763144980491386    0.24414585536758063
σ_m     0.31584845219785207    0.04059747337548122
 27.287366 seconds (615.60 k allocations: 756.472 MiB, 0.54% gc time)
-----------------------------------------------
logML = -130.27630945612876
-----------------------------------------------

20;5000 -> Best result in terms of variance !

-----------------------------------------------
 Iteration = 20 / 20 
-----------------------------------------------
 phi  = 1.0 
-----------------------------------------------
  c    = 0.5188457543602671
  acpt = 0.1554
  ESS  = 3745.8463992188094  (10 total resamples.)
-----------------------------------------------
para      mean    std
------    ----    ----
ρ_A     0.8969711996086493    0.03378570006587342
ρ_μ     0.42260284065345693    0.0699372404030462
ρ_g     0.841687496940513    0.03768551283895658
ρ_R     0.3027155967656424    0.08166445595171165
ρ_π     2.5398438781129418    0.21235520870767005
ρ_y     0.1994217245665472    0.07252908637799699
ψ     0.8321240422850189    0.021702988203633408
σ_A     0.2627126217089657    0.02266624729140628
σ_μ     0.1810299462697654    0.02435718214142496
σ_g     3.2824327788495955    0.14275497503402
σ_m     0.7365289254349219    0.08856776811576947
 29.404260 seconds (597.07 k allocations: 1.075 GiB, 0.77% gc time)
-----------------------------------------------
logML = -138.53695638081172
-----------------------------------------------

60;15000

-----------------------------------------------
 Iteration = 60 / 60 
-----------------------------------------------
 phi  = 1.0 
-----------------------------------------------
  c    = 0.383826131396542
  acpt = 0.23346666666666666
  ESS  = 7838.445122871344  (11 total resamples.)
-----------------------------------------------
para      mean    std
------    ----    ----
ρ_A     0.7492457661041227    0.0701327182615018
ρ_μ     0.3076605105878045    0.1262169158310027
ρ_g     0.7639343507823616    0.038996305542485565
ρ_R     0.604299019340818    0.07992899534014675
ρ_π     2.709248278522957    0.5231704553472365
ρ_y     0.7835610788284533    0.17821149279085302
ψ     0.7823607963598583    0.03093431288856479
σ_A     0.3035892042956899    0.031855718437167606
σ_μ     0.2083433534005768    0.038498891702679464
σ_g     5.64001162783622    0.41061282665179466
σ_m     0.4202169228307564    0.0716281745124836
256.892031 seconds (1.14 M allocations: 10.208 GiB, 0.74% gc time)
-----------------------------------------------
logML = -119.70957550158873
-----------------------------------------------
